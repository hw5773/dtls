#ifndef __PRINCE_H__
#define __PRINCE_H__

#include "bitstring.h"

#define TRUE  1
#define FALSE 0
#define SHARED_SECRET_KEY "0123456789ABCDEF"

static unsigned char RC[12][64] = 
{
  { 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0 }, 
  { 0x1, 0x3, 0x1, 0x9, 0x8, 0xa, 0x2, 0xe, 0x0, 0x3, 0x7, 0x0, 0x7, 0x3, 0x4, 0x4 },
  { 0xa, 0x4, 0x0, 0x9, 0x3, 0x8, 0x2, 0x2, 0x2, 0x9, 0x9, 0xf, 0x3, 0x1, 0xd, 0x0 },
  { 0x0, 0x8, 0x2, 0xe, 0xf, 0xa, 0x9, 0x8, 0xe, 0xc, 0x4, 0xe, 0x6, 0xc, 0x8, 0x9 },
  { 0x4, 0x5, 0x2, 0x8, 0x2, 0x1, 0xe, 0x6, 0x3, 0x8, 0xd, 0x0, 0x1, 0x3, 0x7, 0x7 },
  { 0xb, 0xe, 0x5, 0x4, 0x6, 0x6, 0xc, 0xf, 0x3, 0x4, 0xe, 0x9, 0x0, 0xc, 0x6, 0xc },
  { 0x7, 0xe, 0xf, 0x8, 0x4, 0xf, 0x7, 0x8, 0xf, 0xd, 0x9, 0x5, 0x5, 0xc, 0xb, 0x1 },
  { 0x8, 0x5, 0x8, 0x4, 0x0, 0x8, 0x5, 0x1, 0xf, 0x1, 0xa, 0xc, 0x4, 0x3, 0xa, 0xa },
  { 0xc, 0x8, 0x8, 0x2, 0xd, 0x3, 0x2, 0xf, 0x2, 0x5, 0x3, 0x2, 0x3, 0xc, 0x5, 0x4 },
  { 0x6, 0x4, 0xa, 0x5, 0x1, 0x1, 0x9, 0x5, 0xe, 0x0, 0xe, 0x3, 0x6, 0x1, 0x0, 0xd },
  { 0xd, 0x3, 0xb, 0x5, 0xa, 0x3, 0x9, 0x9, 0xc, 0xa, 0x0, 0xc, 0x2, 0x3, 0x9, 0x9 },
  { 0xc, 0x0, 0xa, 0xc, 0x2, 0x9, 0xb, 0x7, 0xc, 0x9, 0x7, 0xc, 0x5, 0x0, 0xd, 0xd }
};

unsigned char *bitrc[12];

static unsigned char S[16] = { 0xb, 0xf, 0x3, 0x2, 0xa, 0xc, 0x9, 0x1,
  0x6, 0x7, 0x8, 0x0, 0xe, 0x5, 0xd, 0x4 };

static unsigned char Sinv[16] = { 0xb, 0x7, 0x3, 0x2, 0xf, 0xd, 0x8, 0x9,
  0xa, 0x6, 0x4, 0x0, 0x5, 0xe, 0xc, 0x1 };

unsigned char *sbox(unsigned char *data, int dlen, int *rlen, unsigned char *box);
unsigned char *m0(unsigned char *data, int dlen, int *rlen);
unsigned char *m1(unsigned char *data, int dlen, int *rlen);
unsigned char *shiftrows(unsigned char *data, int dlen, int *rlen, int inverse);
unsigned char *mprime(unsigned char *data, int dlen, int *rlen);
unsigned char *firstrounds(unsigned char *data, int dlen, unsigned char *key, int klen, 
    int *rlen);
unsigned char *lastrounds(unsigned char *data, int dlen, unsigned char *key, int klen, 
    int *rlen);
unsigned char *princecore(unsigned char *data, int dlen, unsigned char *key, int klen, 
    int *rlen);
unsigned char *outer(unsigned char *data, int dlen, unsigned char *key, int klen, int *rlen, 
    int decrypt);

int prince_encrypt(unsigned char *key, int klen, unsigned char *msg, int mlen, 
    unsigned char *ciph, int *clen);
int prince_decrypt(unsigned char *key, int klen, unsigned char *ciph, int clen,
    unsigned char *msg, int *mlen);

#endif /* __PRINCE_H__ */
